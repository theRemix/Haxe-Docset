<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><link href="../../bootstrap-combined.min.css" rel="stylesheet" /><script type="text/javascript" src="../../jquery-1.9.1.min.js"></script><script type="text/javascript" src="../../bootstrap.min.js"></script><link href="../../styles.css" rel="stylesheet" /><link rel="icon" href="../../favicon.ico" type="image/x-icon"></link><script type="text/javascript" src="../../nav.js"></script><script type="text/javascript" src="../../index.js"></script><script type="text/javascript">var dox = {rootPath: "../../",platforms: ["cpp","flash","flash8","java","js","neko","php"]};</script><title>ServerLoop</title></head><body><div class="navbar navbar-inverse navbar-fixed-top"><div class="navbar-inner"><form class="navbar-search pull-left" id="searchForm"><input id="search" type="text" class="search-query" placeholder="Filter" autocomplete="off"/></form><ul class="nav"><li id="select-platform" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Platform<b class="caret"></b></a><ul class="dropdown-menu"><li data="all"><a href="#">All Platforms</a></li><li data="cpp"><a href="#">cpp</a></li><li data="flash"><a href="#">flash</a></li><li data="flash8"><a href="#">flash8</a></li><li data="java"><a href="#">java</a></li><li data="js"><a href="#">js</a></li><li data="neko"><a href="#">neko</a></li><li data="php"><a href="#">php</a></li></ul></li></ul></div></div><div id="container"><div id="nav"></div><div id="content"><div class="header"><h1><code><span class="directive">class </span><span class="type">neko.net.ServerLoop</span>&lt;<span class="type">ClientData</span>&gt;</code></h1></div><div class="body"><p class="availability">Available on neko</p><div class="doc"><p>This class enables you to quickly create a custom server that can
serve several clients in parallel. This server is using a single
thread and process so the server itself processing is not parallel.
Non-blocking sockets are used to ensure that a slow client does not
block the others.</p></div><h2>Class Fields</h2><div class="platform platform-neko"><a name="DEFAULT_BUFSIZE"></a><h3><p><code><span class="keyword">static </span><span class="keyword">var</span> <a href="#DEFAULT_BUFSIZE"><span class="identifier">DEFAULT_BUFSIZE</span></a>:<a class="type" href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>Each client has an associated buffer. This is the initial buffer size which
is set to 128 bytes by default.</p></div></div><div class="platform platform-neko"><a name="MAX_BUFSIZE"></a><h3><p><code><span class="keyword">static </span><span class="keyword">var</span> <a href="#MAX_BUFSIZE"><span class="identifier">MAX_BUFSIZE</span></a>:<a class="type" href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>Each client has an associated buffer. This is the maximum buffer size which
is set to 64K by default. When that size is reached and some data can't be processed,
the client is disconnected.</p></div></div><h2>Instance Fields</h2><div class="platform platform-neko"><a name="clients"></a><h3><p><code><span class="keyword">var</span> <a href="#clients"><span class="identifier">clients</span></a>:<a class="type" href="../../List.html">List</a>&lt;<span class="type">ClientData</span>&gt;</code></p></h3><div class="doc"><p></p></div></div><div class="platform platform-neko"><a name="listenCount"></a><h3><p><code><span class="keyword">var</span> <a href="#listenCount"><span class="identifier">listenCount</span></a>:<a class="type" href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>This is the value of number client requests that the server socket
listen for. By default this number is 10 but can be increased for
servers supporting a large number of simultaneous requests.</p></div></div><div class="platform platform-neko"><a name="updateTime"></a><h3><p><code><span class="keyword">var</span> <a href="#updateTime"><span class="identifier">updateTime</span></a>:<a class="type" href="../../Float.html">Float</a></code></p></h3><div class="doc"><p>See [update].</p></div></div><div class="platform platform-neko"><a name="new"></a><h3><p><code><span class="keyword">function</span> <a href="#new"><span class="identifier">new</span></a>(?newData:<a class="type" href="../../sys/net/Socket.html">Socket</a> -&gt;<span class="type">ClientData</span>):<a class="type" href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Creates a server instance. The [newData] methods must return
the data associated with the Client.</p></div></div><div class="platform platform-neko"><a name="clientDisconnected"></a><h3><p><code><span class="keyword">function</span> <a href="#clientDisconnected"><span class="identifier">clientDisconnected</span></a>(d:<span class="type">ClientData</span>):<a class="type" href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>This method is called after a client has been disconnected.</p></div></div><div class="platform platform-neko"><a name="clientWrite"></a><h3><p><code><span class="keyword">function</span> <a href="#clientWrite"><span class="identifier">clientWrite</span></a>(s:<a class="type" href="../../sys/net/Socket.html">Socket</a>, buf:<a class="type" href="../../haxe/io/Bytes.html">Bytes</a>, pos:<a class="type" href="../../Int.html">Int</a>, len:<a class="type" href="../../Int.html">Int</a>):<a class="type" href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>This method can be used instead of writing directly to the socket.
It ensures that all the data is correctly sent. If an error occurs
while sending the data, no exception will occur but the client will
be gracefully disconnected.</p></div></div><div class="platform platform-neko"><a name="closeConnection"></a><h3><p><code><span class="keyword">function</span> <a href="#closeConnection"><span class="identifier">closeConnection</span></a>(s:<a class="type" href="../../sys/net/Socket.html">Socket</a>):<a class="type" href="../../Bool.html">Bool</a></code></p></h3><div class="doc"><p>Closes the client connection and removes it from the client List.</p></div></div><div class="platform platform-neko"><a name="onError"></a><h3><p><code><span class="keyword">function</span> <a href="#onError"><span class="identifier">onError</span></a>(e:<a class="type" href="../../Dynamic.html">Dynamic</a>):<a class="type" href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Called when an error occured. This enable you to log the error somewhere.
By default the error is displayed using [trace].</p></div></div><div class="platform platform-neko"><a name="processClientData"></a><h3><p><code><span class="keyword">function</span> <a href="#processClientData"><span class="identifier">processClientData</span></a>(d:<span class="type">ClientData</span>, buf:<a class="type" href="../../haxe/io/Bytes.html">Bytes</a>, bufpos:<a class="type" href="../../Int.html">Int</a>, buflen:<a class="type" href="../../Int.html">Int</a>):<a class="type" href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>This method is called when some data has been readed into a Client buffer.
If the data can be handled, then you can return the number of bytes handled
that needs to be removed from the buffer. It the data can't be handled (some
part of the message is missing for example), returns 0.</p></div></div><div class="platform platform-neko"><a name="run"></a><h3><p><code><span class="keyword">function</span> <a href="#run"><span class="identifier">run</span></a>(host:<a class="type" href="../../sys/net/Host.html">Host</a>, port:<a class="type" href="../../Int.html">Int</a>):<a class="type" href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Run the server. This function should never return.</p></div></div><div class="platform platform-neko"><a name="update"></a><h3><p><code><span class="keyword">function</span> <a href="#update"><span class="identifier">update</span></a>():<a class="type" href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>The [update] method is called after each socket event has been
processed or when [updateTime] has been reached. It can be used
to perform time-regular tasks such as pings. By default [updateTime]
is set to one second.</p></div></div></div></div></div></body></html>